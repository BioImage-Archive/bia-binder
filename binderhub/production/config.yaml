config:
  BinderHub:
    auth_enabled: false
    hub_url: https://binder.bioimagearchive.org/jhub/


    
jupyterhub:
  hub:
    extraConfig:
        fuseConfig: |
          from kubernetes import client
          def modify_pod_hook(spawner, pod):
            pod.spec.containers[0].security_context = client.V1SecurityContext(
              privileged=True,
              capabilities=client.V1Capabilities(
                  add=['SYS_ADMIN']
              )
            )
            return pod
          c.KubeSpawner.modify_pod_hook = modify_pod_hook
    baseUrl: /jhub
    config:
      GitHubOAuthenticator:
        oauth_callback_url: https://binder.bioimagearchive.org/jhub/hub/oauth_callback
  ingress:
    enabled: true
    hosts:
      - binder.bioimagearchive.org
  custom:
    binderauth_enabled: false

ingress:
  enabled: true
  hosts:
    - "binder.bioimagearchive.org"
  annotations:
    kubernetes.io/ingress.class: nginx
    kubernetes.io/tls-acme: "true"
    cert-manager.k8s.io/acme-challenge-type: http01
    cert-manager.io/cluster-issuer: letsencrypt-production
    # https:
    #   enabled: true
    #   type: nginx
  tls:
    - secretName: binder-bioimagearchive-org-cert
      hosts:
        - "binder.bioimagearchive.org"
dind:
  # enabled: true
  hostLibDir: /var/lib/dind/production
  hostSocketDir: /var/run/dind/production